# NamedEntityGraph

```java
@Entity
@NamedEntityGraph(
  name = "author-books-graph",
  attributeNodes = {
    @NamedAttributeNode("books")
  }
)
public class Author implements Serialzable {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;
    private String genre;
    private int age;

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "author", orphanRemoval = true)
    private List<Book> books;
}
```

## 쿼리 메서드 오버라이딩
- 엔티티 그래프 "author-books-graph"를 사용해서 쿼리 메서드 오버라이딩 가능

```java
@Repository
@Transaction(readOnly = true)
public interface AuthorRepository extends JpaRepository<Author, Long> {
    @Override
    @EntityGraph(value = "author-books-graph", type = EntityGraph.EntityGraphType.FETCH)
    List<Author> findAll();
}
```

## 애드혹 엔티티 그래프
- 애드혹 엔티티 그래프를 사용하면, 엔티티 그래프를 정의하지 않고, 필요한 엔티티 그래프를 사용할 수 있다.
- 엔티티에서 @NamedEntityGraph를 사용하지 않아도 된다. Repository에서 @EntityGraph를 사용하면 된다.

```java
@Repository
@Transaction(readOnly = true)
public interface AuthorRepository extends JpaRepository<Author, Long> {
    @EntityGraph(attributePaths = "books", type = EntityGraph.EntityGraphType.FETCH)
    List<Author> findAll();
}
```

> 애드혹 엔티티 그래프 (ad hoc entity graphs)는 엔티티 그래프를 레포지토리 수준에서 유지할 수 있고, @NamedEntityGraph로 엔티티를 변경하지 않는 편리한 방법


