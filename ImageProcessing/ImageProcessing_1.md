# 영상처리란?

- 스캐너, 디지털 카메라등의 장치를 통하여 획득되었거나 또는 컴퓨터로 생성된 영상을 원하는 목적에 맞게 조작하는 것
- 영상 처리 예
  - 영상의 화질 개선
  - 기하학적 변환
  - 영상의 특징 부각
  - 영상의 압축 / 복원 등



### 디지털 영상 생성

- 디지타이저
  - 아날로그 영상인 자연 영상을 컴퓨터에서 처리하기 위해서는 디지털 영상으로 변환
- 디지타이저의 두 가지 기능
  - 샘플링(sampling)
    - 하나의 영상을 표현하기 위하여 동등한 공간 크기로 데이터를 획득
  - 양자화(quantization)
    - 샘플링된 데이터에 수치값을 할당



### 컬러 모델

- 응용분야에 따라 각기 다른 컬러모델을 사용
  - CMY : 컬러로 된 그림을 출판하는 시스템
  - RGB : 컬러 모니터와 컴퓨터 그래픽스 시스템
  - HSI : 색상, 채도, 명도를 다루어야 하는 시스템

- RGB 컬러모델 : Red, Green, Blue
- CMY 컬러모델 : 청록(Cyan), 자홍(Magenta), 노랑(Yellow)
- HSI 컬러모델 : 색상(Hue), 채도(Saturation), 명도(Intensity)
  - 많은 영상처리 어플리케이션이 HSI 모델 사용
  - RGB 모델 -> HSI 모델 변환
- $YC_bC_r$ : JPEG 압축에 사용
  - 컬러 정보로부터 광도를 분리하는 컬러 모형
  - Y : 광도
  - $C_b$: 푸른 정도
  - $C_r$: 붉은 정도 
- YUV : 디지털 TV 방송 / 비디오에서 사용



### 영상 파일 형식

- RAW
  - 영상의 픽셀 값만을 저장하는 형식
  - 영상을 읽기 위해서는 먼저 영상의 크기를 알고 있어야 하는 불편이 있음
- PBM, PGM, PPM
  - PBM(이진), PGM(흑백), PPM(컬러)
  - 헤더와 데이터부로 구성
    - 헤더는 ASCII 코드로 되어있어 일반 텍스트 편집기로 볼 수 있음
    - P1 ~ P3 까지는 데이터부의 픽셀값이 ASCII 문자임
    - P3 ~ P6 까지는 데이터부의 픽셀값이 이진수임
- PBM, PGM, PPM의 데이터부 형식
  - 영상은 2차원 이지만 파일은 1차원 구조임
  - 데이터부는 영상의 좌측 상단에서 우측 하단 방향으로 한 줄씩 차례대로 기록됨
  - PPM 형식의 경우 한 픽셀 당 R,G,B 의 세 값이 저장 됨



### 기본적인 영상처리 알고리즘의 분류

- 픽셀 기반 처리
  - 단일 영상 : 픽셀의 원래 값이나 위치에 기반한 픽셀 값을 변경
  - 여러 영상 : 두 개 이상의 영상들에 대한 연산을 기반으로 하여 픽셀 값들을 생성함
- 영역 기반 처리 : 픽셀의 원래 값과 이웃하는 픽셀의 값을 기반으로 하여 픽셀 값을 변경
- 기하학적 처리 : 픽셀의 위치나 배열을 변화시킴



### 가산과 감산에 의한 컬러

- RGB 컬러 모형 : 가산 색 모형
- CMY 컬러 모형 : 감산 색 모형



### 영상 출력 프로그램(파일 입출력)

- [MFC 응용프로그램 마법사에 의해 생성된 기본 프로그램에는 영상 파일 입출력을 위해 Serialize() 함수가 제공
- ar.Read(inputImg, 256 * 256)
  - 파일로부터 256 * 256 바이트의 데이터를 읽어들여 inputImg 배열에 저장
- GetLength()
  - 파일의 크기를 반환
- ar.Write(resultImg, 256 * 256)
  - resultImg 배열에서 영상을 출력 파일에 저장



### 영상 출력 프로그램(스크롤 설정)

- 스크롤 윈도우 크기 설정
  - 윈도우의 크기보다 영상의 크기가 클 경우네는 스크롤 시키면서 영상을 볼 수 있도록 해야 함
  - 스크롤 크기는 CImagePropView 클래스의 OnInitialUpdate() 함수에서 지정



### 영상 출력 프로그램(화면 출력)

- 화면 출력은 CImagePropView 클래스의 OnDraw() 함수에서 관장함
- 화면 출력에 관한 기능은 OnDraw() 함수에 작성해야 함

- SetPixel(x, y, color) 함수 호출
  - (x,y) 위치에 color 값의 점을 그려줌
- RGB(r, g, b) 함수 호출
  - 빨강색 성분의 값이 r이고 초록색 성분 값이 g 이고 파랑색 성분 값이 b인 색을 반환
- GetDocument() 함수 호출
  - CImageProDoc 클래스 객체에 대한 포인터를 반환
    - CImageProDoc 클래스에 선언되어 있는 변수나 함수를 사용하기 위해서는 이 포인터를 사용해야 함

### 기본 클래스

- CImageProDoc 클래스
  - 데이터의 저장이나 변환같은 실질적인 데이터 처리를 담당
- CImageProView 클래스
  - CImageProDoc에서 처리된 데이터를 출력장치를 통해서 보여주는 담당
- CMainFrame 클래스
  - 프로그램 전체 윈도우에 대한 관리를 담당
- CChildFrame 클래스
  - 프로그램 윈도우 안에 생성되는 여러 개의 서브 윈도우에 대한 관리를 담당
- CAboutDlg 클래스
  - 프로그램의 [도움말] 메뉴의 "ImagePro 정보"라는 항목을 선택하면 나타나는 대화상자에 대한 관리 담당
- CImageProApp 클래스
  - ImagePro 프로그램 전체에 대한 관리를 담당