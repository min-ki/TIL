# 영역 기반 처리

- 입력 화소와 그 주위 화소를 이용하여 출력 화소값을 결정
- 회선(convolution) 기법을 널리 이용
- 영역 기반 처리 예시
  - 흐리게 하기, 선명하게 하기, 경계선 검출, 잡음 제거



### 회선(convolution)

회선은 출력 픽셀의 값을 입력 픽셀과 그 주위의 픽셀 값에 회선 마스크의 값을 곱하여 합한 값으로 나타내는 방법이다.



#### 회선의 수행 방법

1. 좌측 상단의 픽셀부터 한 픽셀 씩 차례로 수행
   - 먼저 우측 방향으로 진행
   - 한 줄이 끝나면 아래 줄로 이동



#### 회선 마스크의 특성

- 회선 마스크의 크기는 홀수를 사용
  - 주의 픽셀 값을 각 방향에 대칭적으로 고려해야 하므로
  - 3 * 3, 5 * 5, 7 * 7 등의 크기 사용
- 많은 회선 마스크들은 계수들의 합이 1 이됨
  - 회선된 영상은 원영상과 같은 평균 밝기 값을 가짐
- 경계선 검출등 일부 회선 마스크에서는 음수의 계수를 포함하고 계수 합이 0 이됨
  - 음의 화소값들이 생성될 수 있으므로 젼형적으로 생성된 화소값에 일정한 상수(최대밝기/2)가 더해짐



### 영상의 경계 처리

- 0 삽입 : 윈도우의 빈 셀들의 계수를 0으로 가정함
- 윈도우가 영상과 중첩되는 첫 위치에서 회선이 시작
  - 마스크가 3 * 3 일 때에 (0, 0)대신 (1, 1)에서 시작
- 원영상의 크기를 조정
  - 영상의 경계부븐의 화소들을 복사
  - 영상을 둘러쌈



### 영상 흐리게 하기

입력 픽셀 값을 주위 픽셀 값들과의 평균 값으로 변환하는 다음과 같은 회선 마스크를 널리 사용

$M = \begin{bmatrix} \frac{1}{9} & \frac{1}{9} & \frac{1}{9} \\ \frac{1}{9} & \frac{1}{9} & \frac{1}{9}  \\ \frac{1}{9} & \frac{1}{9} & \frac{1}{9}  \end{bmatrix}$



$M = \begin{bmatrix} \frac{1}{25} & \frac{1}{25} & \frac{1}{25} & \frac{1}{25} & \frac{1}{25} \\ \frac{1}{25} & \frac{1}{25} & \frac{1}{25}  & \frac{1}{25} & \frac{1}{25} \\ \frac{1}{25} & \frac{1}{25} & \frac{1}{25}  & \frac{1}{25} & \frac{1}{25} \\ \frac{1}{25} & \frac{1}{25} & \frac{1}{25}  & \frac{1}{25} & \frac{1}{25} \\ \frac{1}{25} & \frac{1}{25} & \frac{1}{25}  & \frac{1}{25} & \frac{1}{25} \end{bmatrix}$



### 영상의 선명화

선명한 영상 생성을 위한 회선 마스크

1)마스크 1 $M = \begin{bmatrix} 0 & -1 & 0 \\ -1 & 5 & -1  \\ 0 & -1 & 0  \end{bmatrix}$



2) 마스크 2  $M = \begin{bmatrix} -1 & -1 & -1 \\ -1 & 9 & -1  \\ -1 & -1 & -1  \end{bmatrix}$



### 경계선 검출

- 경계선

  - 입력 영상에 대한 많은 정보 포함
  - 물체를 식별하고 물체의 위치, 모양, 크기 등을 인지하는 데 큰 역할
  - 영상의 밝기가 낮은 값에서 높은 값으로 또는 높은 값에서 낮은 값으로 변하는 지점에 존재

- 경계선 검출 회선 마스크

  - 미분 연산을 회선 마스크로 표현 가능

    - 수평 경계선과 수직 경계선을 개별적으로 검출

    |         | 수평   경계선                                                | 수직   경계선                                                |
    | ------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
    | Prewitt | $\begin{bmatrix} -1 & -1 & -1 \\ 0 & 0 & 0 \\ 1 & 1 & 1 \end{bmatrix}$ | $\begin{bmatrix} 1 & 0 & -1 \\ 1 & 0 & -1 \\ 1 & 0 & -1 \end{bmatrix}$ |
    | Roberts | $\begin{bmatrix} -1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{bmatrix}$ | $\begin{bmatrix} 0 & 0 & -1 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{bmatrix}$ |
    | Sobel   | $\begin{bmatrix} -1 & -2 & -1 \\ 0 & 0 & 0 \\ 1 & 2 & 1 \end{bmatrix}$ | $\begin{bmatrix} 1 & 0 & -1 \\ 2 & 0 & -2 \\ 1 & 0 & -1 \end{bmatrix}$ |

- 경계선 크기 계산

  - 픽셀 I(x,y)가 경계선일 가능성의 크기

    - $E(x,y) = \sqrt{E_r^2(x,y)+E_c^2(x,y)}$

    - $E_r(x,y) $: 수평 경계선 검출용 회선 마스크 적용 결과 값

    - $E_c(x,y)$ : 수직 경계선 검출용 회선 마스크 적용 결과 값


### 잡음

#### 잡음의 종류

- 가우시안 잡음
  - 정규 분포를 갖는 잡음
  - 영상의 픽셀 값으로부터 불규칙적으로 벗어나지만 뚜렷하게 벗어나지 않는 잡음
- 임펄스 잡음
  - 영상의 픽셀 값과는 뚜렷하게 다른 픽셀 값에 의한 잡음
  - 0, 255와 같은 뚜렷하게 잘못된 밝기 값을 갖는 화소

#### 잡음의 제거

- 평균 마스크
  - 가우시안 노이즈를 줄이는데 효과적
  - 임펄스 노이즈에는 비효과적
  - 영상의 대비를 약화시킴
- 중간값 필터링
  - 임펄스 잡음을 제거하기 위한 효과적인 방법
  - 경계선을 보존 또는 강화



