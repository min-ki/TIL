## 6장 데이터베이스의 내부적 운영

데이터베이스의 저장

- 데이터베이스의 내부적 운영
  - 데이터를 저장하는 방법과 접근에 관련된 작업
  - 디스크(DASD) 사용
    - 디스크 접근(디스크 I/0) 횟수를 최소화
- 디스크 접근시간(access time)
  - 헤드가 원하는 트랙에 있는 레코드를 찾아 전송하는데 걸리는 시간
  - 탐구시간
  - 회전지연 시간
  - 데이터 전송 시간
  - 주기억장치 접근시간에 비해 느림
    - I/o 횟수의 최소화가 가중 중요한 성능 개선 방법
    - 디스크에의 배치, 저장이 중요한 문제
- 저장구조
  - 디스크에 데이터가 배치, 저장되는 형식
  - 다양한 저장구조 지원
    - DB의 부분별로 적절한 저장
    - 성능요건 변경 시 저장 구조 변경
  - 데이터베이스의 물리적 설계
    - DB의 사용 방법, 응용, 응용 실행 빈도수에 따라 적절한 저장방식을 선정하는 과정
- 디스크 관리자
  - 기본 I/O 서비스
    - 모든 물리적 I/O 연산에 대한 책임
    - 운영체제의 한 구성요소
  - 물리적 디스크 주소
  - 파일 관리자 지원
    - 디스크를 일정 크기의 페이지로 구성된 페이지 세트들의 논리적 집단으로 취급하도록 지원
    - 데이터 페이지 세트와 하나의 자유공간 페이지 세트
    - 페이지 세트 : 유일한 페이지 세트 ID
    - 페이지 : 해당 디스크 내에서 유일한 페이지 번호
- 화일 관리자
  - DBMS가 디스크를 저장 화일들의 집합으로 취급할 수 있도록 지원
  - 저장화일(stored file)
    - 한 타입의 저장레코드 어커런스들의 집합
    - 한 페이지 셑은 하나 이상의 저장 화일을 포함
    - 화일이름 또는 화일 ID로 식별
  - 저장 레코드는 레코드 번호 또는 레코드 ID(RID : Record Identifier)로 식별
    - 전체 디스크 내에서 유일
    - (페이지 번호, 페이지 오프셋)
  - OS의 한 구성요소 또는 DBMS와 함께 패키지화



- 페이지 세트와 화일

  - 디스크 관리자
    - 화일관리자가 물리적 디스크 I/O가 아닌 논리적인 페이지 I/O로 관리할 수 있게끔 지원
    - 페이지 관리(page management)

- 연산

  - 처음(빈 디스크)
    - 하나의 자유 공간 페이지 세트만 존재(1~27)
    - 페이지 0은 제외 : 디스크 디렉토리
  - 화일관리자 : 학생 화일에 있는 5개의 레코드 적재
    - 디스크 관리자 : 자유공간 페이지 세트의 페이지 1에서 5까지를 "학생 페이지 세트"라고 이름을 붙이고 할당
  - 과목과 등록 화일에 대한 페이지 세트를 할당
    - 4개의 페이지 세트가 만들어짐
    - 학생(1~5), 과목(6~10), 등록(11~21), 자유공간 페이지세트(22~27)
  - 화일관리자 : 새로운 학생 S6( 학번 600 )을 삽입
    - 디스크 관리자 : 첫 번째 자유 페이지(페이지 22)를 자유공간 페이지 세트에서 찾아서 학생 페이지 세트에 첨가
  - 화일관리자 : S2( 학번 200)를 삭제
    - 디스크 관리자 : 이 레코드가 저장되어 있던 페이지(페이지2)를 자유공간 페이지 세트로 반납
  - 화일관리자 : 새로운 과목 C6(E 515)를 삽입
    - 디스크 관리자 : 자유공간 페이지 세트에서 첫번 째 자유페이지(페이지 2)를 찾아서 과목 페이지 세트에 첨가
  - 화일 관리자 : S4를 삭제
    - 디스크 관리자 : S4가 저장되어 있던 페이지(페이지 4)를 자유공간 페이지 세트에 반납

  ** 삽입, 삭제 연산 실행 후에는 페이지들의 물리적 인접성이 없어진다.



### 포인터 표현 방법

- 한 페이지 세트에서 페이지의 논리적 순서가 물리적 인접으로 표현되지 않음
  - 페이지 : 페이지 헤드 제어정보 저장
  - 포인터 : 논리적 순서에 따른 다음 페이지의 물리적 주소
  - 다음 페이지 포인터는 디스크 관리자가 관리(화일 관리자는 무관)
- 디스크 디렉토리(페이지 세트 디렉토리)
  - 실린더 0, 트랙 0에 위치
  - 디스크에 있는 모든 페이지 세트의 리스트와 각 페이지 세트의 첫번 째 페이지에 대한 포인터 저장



### 화일 관리자

- 저장 레코드 관리 (stored record management)
  - DBMS가 페이지 I/O에 대한 세부적인 사항에 대해 알 필요 없이 저장화일과 저장 레코드만으로 동작하게 함
  - 한 페이지 내에서 저장레코드의 논리적 순서는 그 페이지 내에서의 물리적 순서로 표현 가능
    - 레코드들이 페이지 내에서 이동
    - 레코드들을 모두 페이지 윗 쪽으로 저장
      - 아래쪽은 계속적으로 자유공간으로 유지



### RID의 구현

RID = (페이지 번호p, 오프 셋)

페이지 오프 셋 = 페이지 내에서의 레코드의 위치(byte)

레코드가 한 페이지 내에서 이동할 때마다 RID의 변경 없이 페이지 오프 셋의 포인터만 변경

최악의 경우 두번째 접근으로 원하는 레코드 검색 가능



